# 贡献多语言评估

## 贡献小型翻译

我们定义了19个`literals`，这些是在自动创建评估提示时使用的基本关键词或标点符号，例如`yes`、`no`、`because`等。

我们欢迎您提供您语言的翻译！

要贡献，您需要：
1. 打开[translation_literals](https://github.com/huggingface/lighteval/blob/main/src/lighteval/tasks/templates/utils/translation_literals.py)文件
2. 编辑文件，为您感兴趣的语言添加或扩展字面量。

```python
    Language.ENGLISH: TranslationLiterals(
        language=Language.ENGLISH,
        question_word="question", # 用法："Question: How are you?"
        answer="answer", # 用法："Answer: I am fine"
        confirmation_word="right", # 用法："He is smart, right?"
        yes="yes", # 用法："Yes, he is"
        no="no", # 用法："No, he is not"
        also="also", # 用法："Also, she is smart."
        cause_word="because", # 用法："She is smart, because she is tall"
        effect_word="therefore", # 用法："He is tall therefore he is smart"
        or_word="or", # 用法："He is tall or small"
        true="true", # 用法："He is smart, true, false or neither?"
        false="false", # 用法："He is smart, true, false or neither?"
        neither="neither", # 用法："He is smart, true, false or neither?"
        # 标点和间距：仅在您的语言使用与英语不同的内容时调整
        full_stop=".",
        comma=",",
        question_mark="?",
        exclamation_mark="!",
        word_space=" ",
        sentence_space=" ",
        colon=":",
        # 用于枚举的字母表的第一个字符，如果与英语不同
        indices=["A", "B", "C", ...]
    )
```

3. 提交带有您修改的PR！就是这样！

## 贡献新的多语言任务

您应该首先阅读我们关于[添加自定义任务](adding-a-custom-task)的指南，以更好地理解我们使用的不同参数。

然后，您应该查看当前的[多语言任务](https://github.com/huggingface/lighteval/blob/main/src/lighteval/tasks/multilingual/tasks.py)文件，以了解它们是如何定义的。对于多语言评估，`prompt_function`应该由语言适应模板实现。模板将负责正确的格式化，正确且一致地使用语言调整的提示锚点（例如问题/回答）和标点符号。

浏览[此处](https://github.com/huggingface/lighteval/tree/main/src/lighteval/tasks/templates)的所有模板列表，以查看哪些最适合您自己的任务。

然后，准备好后，要定义您自己的任务，您应该：
1. 按照上述指南创建一个Python文件
2. 导入与您的任务类型相关的模板（XNLI、Copa、多项选择、问答等）
3. 使用我们可参数化的[`~tasks.lighteval_task.LightevalTaskConfig`]类为每个相关语言和评估表述（对于多项选择）定义一个或一组任务

```python
your_tasks = [
    LightevalTaskConfig(
        # 您的评估名称
        name=f"evalname_{language.value}_{formulation.name.lower()}",
        # 此评估由社区贡献
        suite=["community"],
        # 这将自动获取您所选表述的正确指标
        metric=get_metrics_for_formulation(
            formulation,
            [
                loglikelihood_acc_metric(normalization=None),
                loglikelihood_acc_metric(normalization=LogProbTokenNorm()),
                loglikelihood_acc_metric(normalization=LogProbCharNorm()),
            ],
        ),
        # 在此函数中，您选择要遵循的模板以及使用哪种语言和表述
        prompt_function=get_template_prompt_function(
            language=language,
            # 然后使用适配器定义模板键（左）和数据集键（右）之间的映射
            # 要了解需要哪些模板键以及可用哪些模板键，
            # 请查阅相应的适配器类型和文档字符串。
            adapter=lambda line: {
                "key": line["relevant_key"],
                ...
            },
            formulation=formulation,
        ),
        # 您还可以添加特定过滤器以删除不相关的样本
        hf_filter=lambda line: line["label"] in <condition>,
        # 然后选择您的huggingface数据集以及可用于评估的分割
        hf_repo=<dataset>,
        hf_subset=<subset>,
        evaluation_splits=["train"],
        hf_avail_splits=["train"],
    )
    for language in [
        Language.YOUR_LANGUAGE, ...
    ]
    for formulation in [MCFFormulation(), CFFormulation(), HybridFormulation()]
]
```
4. 然后，您可以回到指南，测试您的任务是否正确实现！

> [!TIP]
> 所有[`~tasks.lighteval_task.LightevalTaskConfig`]参数都是强类型的，包括模板函数的输入。确保利用您的IDE的功能，使正确填写这些参数变得更容易。


一旦一切就绪，提交PR，我们将很乐意审查它！ 